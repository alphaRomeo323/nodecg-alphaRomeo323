<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Information(WIP)</title>
    <style>
        button {
		font-size: large;
	    }
    </style>
</head>
<body>
    <form name="informationEdit" method="post" action="#">
    <div>
        <label for="logo">Logo</label>
    </div>
    <select id="pulldown" name="pulldown"></select>
	<div>
        <label for="title">Title</label>
    </div>
    <input type="text" id="title" name="title" size="40">
	<div>
        <label for="info">Information</label>
    </div>
    <textarea name="info" id="info" cols="40" rows="3"></textarea>
    <div>
        <lavel for="startTime">Start & End Time</lavel>
    </div>
    <input type="time" id="startTime" name="startTime" size="10">~<input type="time" id="endTime" name="endTime" size="10">
    </form>
    <div>
    <button id="reload">Reload</button>
	<button id="apply">Apply</button>
    <button id="lock"><span id="is-lock"></span></button>
    </div>
</body>
<script>
    const isLock = document.getElementById("is-lock");
    const pulldownElm = document.getElementById("pulldown");
    const titleElm = document.getElementById("title");
    const infoElm = document.getElementById("info");
    const startElm = document.getElementById("startTime");
    const endElm = document.getElementById("endTime");
    const reloadRep = document.getElementById("reload");
    const lockRep = nodecg.Replicant("lock");
    const titleRep = nodecg.Replicant("title");
    const infoRep = nodecg.Replicant("info");
    const startRep = nodecg.Replicant("start-time");
    const endRep = nodecg.Replicant("end-time");
    const stream = nodecg.Replicant("stream");
    const logoRep = nodecg.Replicant("logo");
    const logoAsset = nodecg.Replicant("assets:logos");
    const form = document.forms.informationEdit;

	document.getElementById("lock").onclick = () => {
        if(lockRep.value == "lock"){
            lockRep.value = "unlock";
        }
        else{
        lockRep.value = "lock";
        }
	};
    lockRep.on("change", (newValue) => {
        if(lockRep.value == "lock"){
            isLock.innerText = "Unlock";
            titleElm.disabled = true;
            infoElm.disabled = true;
            startElm.disabled = true;
            endElm.disabled = true;
            reloadRep.disabled = true;
            pulldownElm.disabled = true;
        }
        else{
            isLock.innerText = "Lock";
            titleElm.disabled = false;
            infoElm.disabled = false;
            startElm.disabled = false;
            endElm.disabled = false;
            reloadRep.disabled = false;
            pulldownElm.disabled = false;
        }
    });

    document.getElementById("reload").onclick = () => {
		pulldownElm.innerHTML="";
		run();
	}
    document.getElementById("apply").onclick = () =>
    {
        titleRep.value = form.title.value;
        infoRep.value = form.info.value;
        startRep.value = form.startTime.value;
        endRep.value = form.endTime.value;
        send();
    }
    const run = () => {
		logoAsset.on('change', newVal => {
			if(newVal != undefined) {
				for (const assetKey of newVal) {
					let option = document.createElement("option");
					option.text = assetKey.name;
					option.value = assetKey.url;
					pulldown.appendChild(option.cloneNode(true));
				}
			}
		});
	}
    const send = () => {
        logoRep.value = pulldown.selectedOptions[0].value;
        if(stream.value == true){
            stream.value = false;
        }
        else{
            stream.value = true;
        }
	}
    run();
    






</script>