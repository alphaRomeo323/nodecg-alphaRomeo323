<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Fun/Counter</title>

</head>
<body>
    <div><label>Enabled</label><input type="checkbox" id="counter-enabled" name="counter-enabled"></div>
    <div>
        <label>Title</label>
        <input type="text" id="counter-title" name="counter-title" size="30">
        <button id="apply">apply</button>
    </div>
    <div>
        <label>Value</label>
        <input type="number" id="counter-value" name="counter-value" size="10">
        <button id="plus-button" style="font-size: large;">+1</button>
    </div>
</body>
<script>
    const counterElm = document.getElementById("counter-enabled");
    const titleElm = document.getElementById("counter-title");
    const valueElm = document.getElementById("counter-value");
    const counterRep = nodecg.Replicant("counter-enable");
    const titleRep = nodecg.Replicant("counter-title");
    const valueRep = nodecg.Replicant("counter-value");
    const lockRep = nodecg.Replicant("lock");

    NodeCG.waitForReplicants(counterRep, titleRep, valueRep, lockRep).then(() => {
        counterElm.checked = counterRep.value
        lockRep.on("change", (newValue) => {
            titleElm.disabled = newValue;
            valueRep.disabled = newValue;
        });
        counterElm.onchange = () => {
            counterRep.value = counterElm.checked;
        };
        document.getElementById("apply").onclick = () =>{
            titleRep.value = titleElm.value;
            valueRep.value = valueElm.value;
        };
        document.getElementById("plus-button").onclick = () =>{
            valueRep.value++;
        };

        titleRep.on("change",newValue => {
            titleElm.value = newValue;
        });
        valueRep.on("change",newValue => {
            valueElm.value = newValue;
        });
    })
</script>